import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card"
import { Button } from "@/components/ui/button"
import { Badge } from "@/components/ui/badge"
import { ArrowLeft, Zap, Target, AlertTriangle, Monitor, CheckCircle, Info, Shield } from "lucide-react"
import Image from "next/image"
import Link from "next/link"

export default function BasicPentesting1Page() {
  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900">
      {/* Header */}
      <header className="border-b border-slate-700 bg-slate-900/50 backdrop-blur-sm">
        <div className="container mx-auto px-4 py-6">
          <div className="flex items-center gap-4">
            <Link href="/linux">
              <Button
                size="sm"
                className="text-white bg-gradient-to-r from-green-500 to-green-700 hover:opacity-90"
              >
                <ArrowLeft className="w-4 h-4 mr-2" />
                Volver
              </Button>
            </Link>
            <div className="flex items-center gap-3">
              <div className="p-2 bg-gradient-to-r from-green-500 to-green-700 bg-opacity-20 rounded-lg">
                <Zap className="w-6 h-6 text-white" />
              </div>
              <div>
                <h1 className="text-xl font-bold text-white">Reporte: Análisis de Seguridad Basic Pentesting 1</h1>
                <p className="text-slate-400 text-sm">Evaluación completa de vulnerabilidades en Ubuntu 16.04 LTS</p>
              </div>
            </div>
          </div>
        </div>
      </header>

      <div className="container mx-auto px-4 py-8">
        {/* Overview */}
        <Card className="bg-slate-800/50 border-slate-700 mb-8">
          <CardHeader>
            <div className="flex items-start justify-between">
              <div>
                <CardTitle className="text-white text-2xl mb-2">Basic Pentesting 1 Challenge</CardTitle>
                <CardDescription className="text-slate-300 text-base">
                  Basic Pentesting 1 es un desafío de seguridad enfocado en metodologías fundamentales de penetration testing 
                  contra sistemas Ubuntu. Este laboratorio simula un entorno empresarial típico con servicios web WordPress 
                  y configuraciones vulnerables, diseñado para demostrar técnicas de reconocimiento, explotación y post-explotación.
                </CardDescription>
              </div>
              <Badge variant="secondary" className="bg-gradient-to-r from-green-500 to-green-700 text-white">
                Principiante
              </Badge>
            </div>
          </CardHeader>
          <CardContent>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
              <div>
                <span className="text-slate-400">Sistema Operativo:</span>
                <p className="text-white font-medium">Ubuntu 16.04 LTS</p>
              </div>
              <div>
                <span className="text-slate-400">IP Objetivo:</span>
                <p className="text-white font-medium">192.168.101.25</p>
              </div>
              <div>
                <span className="text-slate-400">Usuario Principal:</span>
                <p className="text-white font-medium">marlinspike</p>
              </div>
            </div>
          </CardContent>
        </Card>

        <div className="grid grid-cols-1 lg:grid-cols-3 gap-8">
          {/* Main Content */}
          <div className="lg:col-span-2 space-y-8">
            {/* Introducción del Entorno */}
            <Card className="bg-slate-800/50 border-slate-700">
              <CardHeader>
                <CardTitle className="text-white flex items-center gap-2">
                  <Monitor className="w-5 h-5" />
                  Introducción: Configuración del Entorno de Pruebas
                </CardTitle>
              </CardHeader>
              <CardContent>
                <div className="space-y-4">
                  <p className="text-slate-300 text-sm leading-relaxed">
                    El Basic Pentesting 1 Challenge representa un escenario realista de evaluación de seguridad contra 
                    una infraestructura Ubuntu 16.04 LTS. Este sistema incluye servicios web Apache con WordPress, 
                    servicios de red básicos y configuraciones típicas de un entorno empresarial pequeño a mediano.
                  </p>
                  
                  <div className="bg-slate-900 rounded-lg p-4 border border-slate-600">
                    <h4 className="text-white font-medium mb-3">Especificaciones del Objetivo:</h4>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                      <div className="space-y-1">
                        <p className="text-slate-400">Distribución:</p>
                        <p className="text-white">Ubuntu 16.04 LTS (Xenial Xerus)</p>
                      </div>
                      <div className="space-y-1">
                        <p className="text-slate-400">Servidor Web:</p>
                        <p className="text-white">Apache HTTP Server</p>
                      </div>
                      <div className="space-y-1">
                        <p className="text-slate-400">CMS:</p>
                        <p className="text-white">WordPress (versión vulnerable)</p>
                      </div>
                      <div className="space-y-1">
                        <p className="text-slate-400">Servicios Activos:</p>
                        <p className="text-white">FTP, SSH, HTTP</p>
                      </div>
                    </div>
                  </div>
                  
                  <p className="text-slate-300 text-sm leading-relaxed">
                    La máquina está configurada con credenciales débiles y configuraciones inseguras intencionalmente, 
                    proporcionando un ambiente ideal para practicar técnicas de pentesting web y escalada de privilegios 
                    en sistemas Linux.
                  </p>
                </div>
              </CardContent>
            </Card>

            {/* Objetivos */}
            <Card className="bg-slate-800/50 border-slate-700">
              <CardHeader>
                <CardTitle className="text-white flex items-center gap-2">
                  <Target className="w-5 h-5" />
                  Objetivos del Análisis
                </CardTitle>
              </CardHeader>
              <CardContent>
                <ul className="space-y-2">
                  {[
                    "Realizar reconocimiento exhaustivo de red y servicios",
                    "Enumerar directorios y archivos web mediante fuzzing",
                    "Identificar instalaciones de WordPress y sus vulnerabilidades",
                    "Ejecutar ataques de fuerza bruta contra credenciales",
                    "Explotar vulnerabilidades de WordPress para obtener shell",
                    "Extraer hashes de contraseñas del sistema comprometido",
                    "Demostrar técnicas de post-explotación y persistencia"
                  ].map((item, idx) => (
                    <li key={idx} className="flex items-center gap-2 text-slate-300">
                      <div className="w-2 h-2 bg-green-400 rounded-full" />
                      {item}
                    </li>
                  ))}
                </ul>
              </CardContent>
            </Card>

            {/* Metodología de Pentesting */}
            <Card className="bg-slate-800/50 border-slate-700">
              <CardHeader>
                <CardTitle className="text-white">Metodología y Ejecución del Pentesting</CardTitle>
              </CardHeader>
              <CardContent className="space-y-8">
                {[
                  {
                    title: "1. Reconocimiento Inicial: Pantalla de Sistema",
                    description: "Se observa la pantalla de autenticación del sistema Ubuntu 16.04 LTS, identificando el usuario 'marlinspike' y confirmando la versión del sistema operativo objetivo.",
                    command: "N/A (Observación directa)",
                    imageText: "Interfaz de login de Ubuntu mostrando usuario marlinspike disponible",
                    imageSrc: "/assets/p1.png"
                  },
                  {
                    title: "2. Escaneo de Red y Enumeración de Servicios",
                    description: "Se ejecuta un escaneo completo con Nmap para identificar servicios activos, versiones de software y posibles vectores de ataque en el host objetivo.",
                    command: "sudo nmap -A -T4 192.168.101.25",
                    imageText: "Detección de servicios FTP (21), SSH (22) y HTTP (80) activos",
                    imageSrc: "/assets/p2.png"
                  },
                  {
                    title: "3. Reconocimiento Web: Página por Defecto",
                    description: "Se accede al servicio HTTP para confirmar que Apache está funcionando y evaluar la superficie de ataque web disponible.",
                    command: "curl -I http://192.168.101.25",
                    imageText: "Página de bienvenida de Apache confirmando servicio web activo",
                    imageSrc: "/assets/p3.png"
                  },
                  {
                    title: "4. Fuzzing de Directorios con Dirb",
                    description: "Se utiliza dirb para descubrir directorios ocultos y archivos sensibles en el servidor web, revelando rutas críticas como /secret/.",
                    command: "dirb http://192.168.101.25",
                    imageText: "Descubrimiento de directorio /secret/ y archivos WordPress",
                    imageSrc: "/assets/p4.png"
                  },
                  {
                    title: "5. Identificación de WordPress",
                    description: "Se accede al directorio /secret/ descubierto, revelando una instalación de WordPress con página de autenticación activa.",
                    command: "curl http://192.168.101.25/secret/wp-login.php",
                    imageText: "Página de login de WordPress ubicada en directorio oculto",
                    imageSrc: "/assets/p5.png"
                  },
                  {
                    title: "6. Análisis de Vulnerabilidades con WPScan",
                    description: "Se ejecuta WPScan para identificar vulnerabilidades específicas de WordPress, plugins inseguros y configuraciones débiles.",
                    command: "wpscan --url http://192.168.101.25/secret --enumerate vp,vt,u",
                    imageText: "Identificación de vulnerabilidades WordPress y usuarios válidos",
                    imageSrc: "/assets/p6.png"
                  },
                  {
                    title: "7. Ataque de Fuerza Bruta Exitoso",
                    description: "Se ejecuta un ataque de diccionario contra el usuario 'admin' utilizando la wordlist RockYou, obteniendo credenciales válidas.",
                    command: "wpscan --url http://192.168.101.25/secret --usernames admin --passwords /usr/share/wordlists/rockyou.txt",
                    imageText: "Compromiso exitoso con credenciales admin:admin",
                    imageSrc: "/assets/p7.png"
                  },
                  {
                    title: "8. Acceso al Panel de Administración",
                    description: "Se accede al dashboard de WordPress con credenciales comprometidas, obteniendo control total sobre la gestión del sitio web.",
                    command: "N/A (Acceso web)",
                    imageText: "Panel de control WordPress con privilegios administrativos",
                    imageSrc: "/assets/p8.png"
                  },
                  {
                    title: "9. Configuración de Exploit en Metasploit",
                    description: "Se configura el módulo de explotación wp_admin_shell_upload en Metasploit para aprovechar los privilegios administrativos de WordPress.",
                    command: "use exploit/unix/webapp/wp_admin_shell_upload",
                    imageText: "Módulo de Metasploit preparado para explotación WordPress",
                    imageSrc: "/assets/p9.png"
                  },
                  {
                    title: "10. Configuración de Parámetros de Ataque",
                    description: "Se establecen todos los parámetros necesarios para el exploit, incluyendo host objetivo, credenciales y ruta del WordPress.",
                    command: "set RHOSTS 192.168.101.25; set PASSWORD admin; set USERNAME admin; set TARGETURI /secret",
                    imageText: "Parámetros del exploit configurados correctamente",
                    imageSrc: "/assets/p10.png"
                  },
                  {
                    title: "11. Ejecución del Exploit y Obtención de Shell",
                    description: "Se ejecuta el exploit exitosamente, estableciendo una sesión Meterpreter con acceso completo al sistema comprometido.",
                    command: "exploit",
                    imageText: "Sesión Meterpreter establecida con acceso al sistema",
                    imageSrc: "/assets/p11.png"
                  },
                  {
                    title: "12. Extracción de Información Sensible",
                    description: "Se utiliza la sesión comprometida para acceder a archivos críticos del sistema, incluyendo /etc/shadow con hashes de contraseñas.",
                    command: "shell; cat /etc/shadow",
                    imageText: "Acceso a archivo /etc/shadow con hashes de usuarios",
                    imageSrc: "/assets/p12.png"
                  },
                  {
                    title: "13. Cracking de Contraseñas",
                    description: "Se ejecuta John the Ripper contra los hashes extraídos, comprometiendo contraseñas adicionales del sistema.",
                    command: "john --single hash1.txt",
                    imageText: "Cracking exitoso de contraseñas del sistema",
                    imageSrc: "/assets/p13.png"
                  }
                ].map((step, index) => (
                  <div key={index} className="space-y-3">
                    <h4 className="text-lg font-semibold text-white">{step.title}</h4>
                    <p className="text-slate-300 text-sm">{step.description}</p>
                    {step.command !== "N/A (Observación directa)" && step.command !== "N/A (Acceso web)" && (
                      <div className="bg-slate-900 rounded-lg p-3 border border-slate-600 w-fit">
                        <code className="text-green-400 text-sm font-mono">{step.command}</code>
                      </div>
                    )}
                    <div className="bg-slate-700 rounded-lg p-4 text-center space-y-2">
                      <Image
                        src={step.imageSrc}
                        alt={step.imageText}
                        width={600}
                        height={300}
                        className="mx-auto rounded-md border border-slate-600"
                      />
                      <p className="text-slate-400 text-xs">{step.imageText}</p>
                    </div>
                  </div>
                ))}
              </CardContent>
            </Card>

            {/* Conclusiones */}
            <Card className="bg-slate-800/50 border-slate-700">
              <CardHeader>
                <CardTitle className="text-white flex items-center gap-2">
                  <CheckCircle className="w-5 h-5" />
                  Conclusiones y Análisis de Resultados
                </CardTitle>
              </CardHeader>
              <CardContent>
                <div className="space-y-6">
                  <div>
                    <h4 className="text-white font-medium mb-2">Hallazgos Críticos:</h4>
                    <ul className="space-y-2 text-slate-300 text-sm">
                      <li className="flex items-start gap-2">
                        <div className="w-2 h-2 bg-red-400 rounded-full mt-2 flex-shrink-0" />
                        <span>WordPress con credenciales por defecto (admin:admin) permite acceso administrativo completo</span>
                      </li>
                      <li className="flex items-start gap-2">
                        <div className="w-2 h-2 bg-red-400 rounded-full mt-2 flex-shrink-0" />
                        <span>Función de upload de archivos en WordPress permite ejecución remota de código</span>
                      </li>
                      <li className="flex items-start gap-2">
                        <div className="w-2 h-2 bg-red-400 rounded-full mt-2 flex-shrink-0" />
                        <span>Archivo /etc/shadow accesible permitiendo extracción de hashes de contraseñas</span>
                      </li>
                      <li className="flex items-start gap-2">
                        <div className="w-2 h-2 bg-orange-400 rounded-full mt-2 flex-shrink-0" />
                        <span>Servicios FTP y SSH expuestos sin configuraciones de seguridad adicionales</span>
                      </li>
                    </ul>
                  </div>

                  <div>
                    <h4 className="text-white font-medium mb-2">Impacto de Seguridad:</h4>
                    <div className="bg-slate-900 rounded-lg p-4 border border-slate-600">
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div>
                          <p className="text-red-400 font-medium">Compromiso Web</p>
                          <p className="text-slate-300">Control total del sitio WordPress</p>
                        </div>
                        <div>
                          <p className="text-red-400 font-medium">Ejecución de Código</p>
                          <p className="text-slate-300">Shell remoto con privilegios web</p>
                        </div>
                        <div>
                          <p className="text-red-400 font-medium">Acceso a Credenciales</p>
                          <p className="text-slate-300">Hashes de usuarios del sistema</p>
                        </div>
                        <div>
                          <p className="text-orange-400 font-medium">Reconocimiento</p>
                          <p className="text-slate-300">Mapeo completo de servicios</p>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div>
                    <h4 className="text-white font-medium mb-2">Recomendaciones de Remediación:</h4>
                    <ul className="space-y-2 text-slate-300 text-sm">
                      <li className="flex items-start gap-2">
                        <div className="w-2 h-2 bg-green-400 rounded-full mt-2 flex-shrink-0" />
                        <span>Implementar contraseñas robustas y políticas de autenticación fuerte</span>
                      </li>
                      <li className="flex items-start gap-2">
                        <div className="w-2 h-2 bg-green-400 rounded-full mt-2 flex-shrink-0" />
                        <span>Actualizar WordPress a la última versión estable con parches de seguridad</span>
                      </li>
                      <li className="flex items-start gap-2">
                        <div className="w-2 h-2 bg-green-400 rounded-full mt-2 flex-shrink-0" />
                        <span>Configurar permisos restrictivos en archivos críticos del sistema</span>
                      </li>
                      <li className="flex items-start gap-2">
                        <div className="w-2 h-2 bg-green-400 rounded-full mt-2 flex-shrink-0" />
                        <span>Implementar Web Application Firewall (WAF) para proteger aplicaciones web</span>
                      </li>
                      <li className="flex items-start gap-2">
                        <div className="w-2 h-2 bg-green-400 rounded-full mt-2 flex-shrink-0" />
                        <span>Deshabilitar servicios innecesarios y configurar fail2ban para FTP/SSH</span>
                      </li>
                    </ul>
                  </div>

                  <div className="bg-slate-900 rounded-lg p-4 border border-slate-600">
                    <div className="flex items-center gap-2 mb-2">
                      <Info className="w-4 h-4 text-green-400" />
                      <span className="text-white font-medium">Nota Educativa</span>
                    </div>
                    <p className="text-slate-300 text-sm">
                      Este análisis se realizó en un entorno de laboratorio controlado diseñado específicamente 
                      para fines educativos. Las técnicas demostradas ilustran vulnerabilidades comunes en 
                      sistemas WordPress y deben utilizarse exclusivamente para mejorar las defensas de seguridad 
                      en entornos autorizados.
                    </p>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Sidebar */}
          <div className="space-y-6">
            {/* Herramientas */}
            <Card className="bg-slate-800/50 border-slate-700">
              <CardHeader>
                <CardTitle className="text-white text-lg">Herramientas de Pentesting</CardTitle>
              </CardHeader>
              <CardContent>
                <div className="flex flex-wrap gap-2">
                  {[
                    "Nmap", 
                    "Dirb", 
                    "WPScan", 
                    "Metasploit", 
                    "Meterpreter",
                    "John the Ripper"
                  ].map((tool) => (
                    <Badge key={tool} variant="outline" className="text-slate-300 border-slate-600">
                      {tool}
                    </Badge>
                  ))}
                </div>
              </CardContent>
            </Card>

            {/* Vulnerabilidades */}
            <Card className="bg-slate-800/50 border-slate-700">
              <CardHeader>
                <CardTitle className="text-white text-lg flex items-center gap-2">
                  <AlertTriangle className="w-4 h-4" />
                  Vulnerabilidades Identificadas
                </CardTitle>
              </CardHeader>
              <CardContent className="space-y-3">
                {[
                  {
                    name: "WordPress Admin Shell Upload",
                    severity: "Crítica"
                  },
                  {
                    name: "Credenciales por Defecto",
                    severity: "Crítica"
                  },
                  {
                    name: "Directorio Oculto Accesible",
                    severity: "Alta"
                  },
                  {
                    name: "XML-RPC Habilitado",
                    severity: "Media"
                  },
                  {
                    name: "Información de Versión Expuesta",
                    severity: "Baja"
                  }
                ].map((vuln, index) => (
                  <div key={index} className="border border-slate-600 rounded-lg p-3">
                    <div className="flex items-center justify-between mb-1">
                      <span className="text-white text-sm font-medium">{vuln.name}</span>
                      <Badge 
                        variant="outline" 
                        className={`text-xs ${
                          vuln.severity === 'Crítica' ? 'text-red-400 border-red-400' :
                          vuln.severity === 'Alta' ? 'text-orange-400 border-orange-400' : 
                          vuln.severity === 'Media' ? 'text-yellow-400 border-yellow-400' : 
                          'text-green-400 border-green-400'
                        }`}
                      >
                        {vuln.severity}
                      </Badge>
                    </div>
                  </div>
                ))}
              </CardContent>
            </Card>

            {/* Estadísticas del Pentesting */}
            <Card className="bg-slate-800/50 border-slate-700">
              <CardHeader>
                <CardTitle className="text-white text-lg">Métricas del Análisis</CardTitle>
              </CardHeader>
              <CardContent>
                <div className="space-y-3 text-sm">
                  <div className="flex justify-between">
                    <span className="text-slate-400">Hosts Comprometidos:</span>
                    <span className="text-white">1/1</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-slate-400">Servicios Identificados:</span>
                    <span className="text-white">3</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-slate-400">Vulnerabilidades Críticas:</span>
                    <span className="text-red-400">2</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-slate-400">Credenciales Comprometidas:</span>
                    <span className="text-orange-400">Multiple</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-slate-400">Tiempo de Compromiso:</span>
                    <span className="text-white">~1.5 horas</span>
                  </div>
                  <div className="flex justify-between">
                    <span className="text-slate-400">Nivel de Acceso:</span>
                    <span className="text-orange-400">Web Shell</span>
                  </div>
                </div>
              </CardContent>
            </Card>

            {/* Clasificación de Riesgo */}
            <Card className="bg-slate-800/50 border-slate-700">
              <CardHeader>
                <CardTitle className="text-white text-lg flex items-center gap-2">
                  <Shield className="w-4 h-4" />
                  Evaluación de Riesgo
                </CardTitle>
              </CardHeader>
              <CardContent>
                <div className="space-y-4">
                  <div className="text-center">
                    <div className="text-3xl font-bold text-red-400 mb-1">ALTO</div>
                    <div className="text-slate-400 text-sm">Nivel de Riesgo General</div>
                  </div>
                  <div className="space-y-2 text-sm">
                    <div className="flex justify-between">
                      <span className="text-slate-400">Confidencialidad:</span>
                      <span className="text-red-400">Comprometida</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="text-slate-400">Integridad:</span>
                      <span className="text-orange-400">En Riesgo</span>
                    </div>
                    <div className="flex justify-between">
                      <span className="text-slate-400">Disponibilidad:</span>
                      <span className="text-yellow-400">Estable</span>
                    </div>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>
        </div>
      </div>
    </div>
  )
}